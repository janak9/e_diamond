{% extends 'main_admin/base.html' %}
{% block content %}
{% load static %}
{% comment %} <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css"> {% endcomment %}
<link type="text/css" rel="stylesheet" href="{% static 'main_admin/css/search-style.css' %}"/>
<section class="wrapper">
	<div class="form-w3layouts">
        <div class="row">
            <div class="col-lg-12">
                <section class="panel">
                    <header class="panel-heading">
                        {{ task }} Sub Category
                    </header>
                    <div class="panel-body">
                        {% if msg %}
                            <div class="alert alert-warning radius-both">
                                <p style="color:red;">{{ msg }}</p>
                            </div>
                        {% endif %}
                        <form class="form-horizontal bucket-form" method="post" action="" enctype="multipart/form-data">
                        {% csrf_token %}
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Main Category</label>
                                <div class="col-sm-6">
                                    <select class="form-control m-bot15" name="main_category_id" id="main_category_id" onchange="get_category('main_category_id', 'category_id')" required>
                                        <option value="" readonly>Select Main Category</option>
                                        {% for main_category in main_categories %}
                                            <option value="{{ main_category.pk }}" 
                                            {% if product.main_category_id == main_category.pk %}
                                                selected
                                            {% endif %}>{{ main_category.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Category</label>
                                <div class="col-sm-6">
                                    <select class="form-control m-bot15" name="category_id" id="category_id" onchange="get_sub_category('category_id', 'sub_category_id')" required>
                                        <option value="" readonly>Select Category</option>
                                        {% for category in categories %}
                                            <option value="{{ category.pk }}" 
                                            {% if product.category_id == category.pk %}
                                                selected
                                            {% endif %}>{{ category.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Sub Category</label>
                                <div class="col-sm-6">
                                    <select class="form-control m-bot15" name="sub_category_id" id="sub_category_id" required>
                                        <option value="" readonly>Select Sub Category</option>
                                        {% for sub_category in sub_categories %}
                                            <option value="{{ sub_category.pk }}" 
                                            {% if product.sub_category_id == sub_category.pk %}
                                                selected
                                            {% endif %}>{{ sub_category.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Title</label>
                                <div class="col-sm-6">
                                    <input type="text" class="form-control" name="title" id="title" value="{{ product.title }}" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Description</label>
                                <div class="col-sm-12">
                                    <textarea class="form-control" name="description" id="description">{{ product.description }}</textarea>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Quantity</label>
                                <div class="col-sm-6">
                                    <input type="number" class="form-control" name="qty" id="qty" value="{{ product.qty }}" step="0.1" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">available quantity</label>
                                <div class="col-sm-6">
                                    <input type="number" class="form-control" name="available_qty" id="available_qty" value="{{ product.available_qty }}" step="0.1" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Price</label>
                                <div class="col-sm-6">
                                    <input type="number" class="form-control" name="price" id="price" value="{{ product.price }}" step="0.1" required>
                                </div>
                            </div>
                            {% comment %} <?php   
                $cnt=0; 
                if(@$data)
                {
                  $imgs=explode(',',$data['Image']);
                  for($i=0;$i<count($imgs);$i++) {  
                    $pic="pic".$cnt;
                    $span="span".$cnt;
                    $div_id="file_up_div".$cnt;
                ?>
              <div id="<?php echo $div_id;?>" class="form-group">
                <button type="button" class="close" onclick="remove_img('#<?php echo $div_id;?>');">&times;</button>
                <label for="img_file" class="col-md-3 control-label">Picture
                  <?php echo $cnt+1;?></label>
                <div class="col-md-5">
                  <img id="<?php echo $pic;?>" src="<?php if(@$data){echo base_url('assets/photos/package/'.$imgs[$i]);}?>"
                    height="150px" width="150px">
                  <div class="box">
                    <input type="file" onchange="loadfile1(event,'<?php echo $pic;?>','<?php echo $span;?>')" name="img_file<?php echo $cnt;?>"
                      id="file-<?php echo $cnt;?>" class="inputfile inputfile-2 btn_browse" multiple />
                    <label for="file-<?php echo $cnt;?>" class="form-control"><svg xmlns="http://www.w3.org/2000/svg"
                        width="20" height="17" viewBox="0 0 20 17">
                        <path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z" /></svg>
                      <span id="<?php echo $span;?>" class="span_file">
                        <?php if(@$data){echo $imgs[$i];}else{echo "Choose a file";}?>&hellip;</span></label>
                  </div>
                </div>
                <?php $cnt++; ?>
              </div>
              <?php  }//end of for loop
                }//end of if condition
                else{
                ?>
              <div id="file_up_div0" class="form-group">
                <button type="button" class="close" onclick="remove_img('#file_up_div0');">&times;</button>
                <label for="img_file" class="col-md-3 control-label">Picture 1</label>
                <div class="col-md-5">
                  <img id="pic0" src="" height="150px" width="150px">
                  <div class="box">
                    <input type="file" onchange="loadfile1(event,'pic0','span0')" name="img_file0" id="file-0" class="inputfile inputfile-2 btn_browse"
                      multiple />
                    <label for="file-0" class="form-control"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="17"
                        viewBox="0 0 20 17">
                        <path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z" /></svg>
                      <span id="span0" class="span_file">Choose a file&hellip;</span></label>
                  </div>
                </div>
                <?php $cnt++;?>
              </div>
              <?php  } ?>
              <div class="form-group more_img_div" id="<?php echo 'img'.$cnt;?>">
              </div>
               {% endcomment %}
                            {{ image_form.management_form }}
                            {% for form in image_form %}
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">Image</label>
                                    <div class="col-sm-6">
                                        <input type="file" name="{{ form.src.html_name }}" accept="image/*" class="form-control" id="{{ form.src.auto_id }}" onchange="loadImage(event,'{{ form.src.auto_id }}_preview')" {% ifequal task 'Add' %}required{% endifequal %} >
                                        <img id="{{ form.src.auto_id }}_preview" src="{% if product.image.src %}{{ product.image.src.url }}{% endif %}" height="150" width="150"/>
                                    </div>
                                    <div class="alert-danger" style="background-color: transparent;">
                                        {{ form.src.errors }}
                                    </div>
                                </div>
                            {% endfor %}
                            <div class="row">
                                <div class="col-lg-12">
                                    <section class="panel">
                                        <header class="panel-heading">
                                            Additional Informations
                                            <span class="tools pull-right">
                                                <a class="fa fa-chevron-down" href="javascript:;"></a>
                                            </span>
                                        </header>
                                        <div class="panel-body additional_informations">
                                            <div id="info_list">
                                            {% if product.additional_information.all|length > 0 %}
                                                {% for additional_info in product.additional_information.all %}
                                                <div class="row" id="info_{{ forloop.counter0 }}">
                                                    <div class="col-md-4 form-group" >
                                                        <input type="text" class="form-control" name="info_title_{{ additional_info.pk }}" placeholder="Enter Title" value="{{ additional_info.title }}" required>
                                                    </div>
                                                    <div class="col-md-6 form-group">
                                                        <input type="text" class="form-control" name="info_description_{{ additional_info.pk }}" placeholder="Enter Description" value='{{ additional_info.description }}' required>
                                                    </div>
                                                    <div class="col-md-2 form-group remove">
                                                        <div class="btn btn-danger" onclick="remove_more_info('info_{{ forloop.counter0 }}')"><i class='fa fa-times'></i></div>
                                                    </div>
                                                </div>
                                                {% endfor %}
                                            {% else %}
                                                <div class="row" id="info_0">
                                                    <div class="col-md-4 form-group" >
                                                        <input type="text" class="form-control" name="new_info_title_0" placeholder="Enter Title" value=""  required>
                                                    </div>
                                                    <div class="col-md-6 form-group">
                                                        <input type="text" class="form-control" name="new_info_description_0" placeholder="Enter Description" value='' required>
                                                    </div>
                                                    <div class="col-md-2 form-group remove">
                                                        <div class="btn btn-danger" onclick="remove_more_info('info_0')"><i class='fa fa-times'></i></div>
                                                    </div>
                                                </div>
                                            {% endif %}
                                            </div>
                                            {% comment %} <div class="row more_info_div" id="info_{{ cnt }}"></div> {% endcomment %}
                                            <div class="btn btn-info" id="more_info" onclick="get_more_info(event)" data-cnt="{{ cnt|default:'1' }}">Add More</i></div>
                                        </div>
                                    </section>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-12">
                                    <section class="panel">
                                        <header class="panel-heading">
                                            Social Links
                                            <span class="tools pull-right">
                                                <a class="fa fa-chevron-down" href="javascript:;"></a>
                                            </span>
                                        </header>
                                        <div class="panel-body social_links">
                                            <div id="social_list">
                                            {% if product.social_links.all|length > 0 %}
                                                {% for social_link in product.social_links.all %}
                                                <div class="row" id="social_{{ forloop.counter0 }}">
                                                    <div class="col-md-4 form-group" >
                                                        <input type="text" class="form-control" id="search" placeholder="Search icon" value="" required>
                                                    </div>
                                                    <div class="col-md-6 form-group">
                                                        <div class="input-group">
                                                            <span class="input-group-addon btn-white"><i class="{{ social_link.social_icon }}"></i></span>
                                                            <input type="text" class="form-control" name="social_link_{{ social_link.pk }}" placeholder="Enter Link" value='{{ social_link.link }}' required>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-2 form-group remove">
                                                        <div class="btn btn-danger" onclick="remove_more_info('info_{{ forloop.counter0 }}')"><i class='fa fa-times'></i></div>
                                                    </div>
                                                </div>
                                                {% endfor %}
                                            {% else %}
                                                <div class="row" id="info_0">
                                                    <div class="col-md-4 form-group" >
                                                        <input type="text" class="form-control" id="search" name="search" placeholder="Enter icon" value="" autocomplete="off" autofocus required>
                                                    </div>
                                                    <div class="col-md-6 form-group">
                                                        <input type="text" class="form-control" name="new_social_link_0" placeholder="Enter Link" value='' required>
                                                    </div>
                                                    <div class="col-md-2 form-group remove">
                                                        <div class="btn btn-danger" onclick="remove_more_info('info_0')"><i class='fa fa-times'></i></div>
                                                    </div>
                                                </div>
                                            {% endif %}
                                            </div>
                                            {% comment %} <div class="row more_info_div" id="info_{{ cnt }}"></div> {% endcomment %}
                                            <div class="btn btn-info" id="more_social" onclick="get_more_info(event)" data-cnt="{{ cnt|default:'1' }}">Add More</i></div>
                                            <div class="list" style="max-height: 250px;overflow-y: auto;">
                                                <ul class="icons"></ul>
                                                <div class="clearfix"></div>
                                            </div>
                                        </div>
                                    </section>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Status</label>
                                <div class="col-sm-6">
                                    <select class="form-control m-bot15" name="status" id="status">
                                        <option value="{{ CONST.STATUS_CHOICES.0.0 }}" selected>{{ CONST.STATUS_CHOICES.0.1 }}</option>
                                        <option value="{{ CONST.STATUS_CHOICES.1.0 }}" 
                                        {% if product.status == CONST.STATUS_CHOICES.1.0 %}
                                            selected
                                        {% endif %}
                                            >{{ CONST.STATUS_CHOICES.1.1 }}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label"></label>
                                <div class="col-sm-6">
                                    <button type="submit" class="btn btn-info">Submit</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </section>
            </div>
        </div>
    </div>
</section>
<script type="text/javascript" src="{% static 'main_admin/js/icons.js' %}"></script>
<script type="text/javascript" src="{% static 'main_admin/js/aliases.js' %}"></script>
<script type="text/javascript" src="{% static 'main_admin/js/search-script.js' %}"></script>
<script>
    CKEDITOR.replace('description');
</script>
{% endblock content %}
